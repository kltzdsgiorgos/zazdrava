<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout Details</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
    <div class="max-w-4xl mx-auto mt-8 p-6 bg-white shadow-lg rounded-lg">
        <h2 class="text-2xl font-bold text-blue-600">Workout: {{ workout.name }}</h2>
        <h4 class="text-gray-500">Uploaded: {{ workout.uploaded_at }}</h4>

        <!-- Chart -->
        <div class="mt-6">
            <canvas id="workoutChart"></canvas>
        </div>

        <!-- Data Table -->
        <h3 class="mt-8 text-lg font-semibold">Workout Data</h3>
        <div class="overflow-x-auto mt-3">
            <table class="min-w-full bg-white border border-gray-300 rounded-lg shadow-md">
                <thead class="bg-blue-600 text-white">
                    <tr>
                        <th class="py-2 px-4">Timestamp</th>
                        <th class="py-2 px-4">Altitude (m)</th>
                        <th class="py-2 px-4">Heart Rate (bpm)</th>
                        <th class="py-2 px-4">Speed (m/s)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in workout.records.all %}
                    <tr class="border-b hover:bg-gray-100">
                        <td class="py-2 px-4">{{ record.timestamp }}</td>
                        <td class="py-2 px-4">{{ record.data.altitude|default:"N/A" }}</td>
                        <td class="py-2 px-4">{{ record.data.heart_rate|default:"N/A" }}</td>
                        <td class="py-2 px-4">{{ record.data.enhanced_speed|default:"N/A" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <script>
        var ctx = document.getElementById('workoutChart').getContext('2d');
        var chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: {{ timestamps|safe }},
                datasets: [
                    {
                        label: 'Altitude (m)',
                        data: {{ altitude|safe }},
                        borderColor: 'blue',
                        fill: false
                    },
                    {
                        label: 'Heart Rate (bpm)',
                        data: {{ heart_rate|safe }},
                        borderColor: 'red',
                        fill: false
                    },
                    {
                        label: 'Speed (m/s)',
                        data: {{ speed|safe }},
                        borderColor: 'green',
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    x: { title: { display: true, text: 'Time' } },
                    y: { title: { display: true, text: 'Value' } }
                }
            }
        });
    </script>
</body>
</html>
